
<!-- saved from url=(0045)http://blog.tomtung.com/2011/10/em-algorithm/ -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
<div class="line-gutter-backdrop">
</div>
<table>
<tbody>
<tr>
<td class="line-number" value="1">
</td>
<td class="line-content">
<span class="html-doctype">&lt;!DOCTYPE html&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="2">
</td>
<td class="line-content">
<span class="html-tag">&lt;html <span class="html-attribute-name">lang</span>="<span class="html-attribute-value">en</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="3">
</td>
<td class="line-content">
<span class="html-tag">&lt;head&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="4">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="5">
</td>
<td class="line-content">        <span class="html-tag">&lt;title&gt;</span>Expectation-Maximization(EM)&nbsp;算法 - ~/blog<span class="html-tag">&lt;/title&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="6">
</td>
<td class="line-content">        <span class="html-tag">&lt;meta <span class="html-attribute-name">charset</span>="<span class="html-attribute-value">utf-8</span>" /&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="7">
</td>
<td class="line-content">        <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://blog.tomtung.com/feed/all.atom.xml">http://blog.tomtung.com/feed/all.atom.xml</a>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">application/atom+xml</span>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">alternate</span>" <span class="html-attribute-name">title</span>="<span class="html-attribute-value">~/blog Full Atom Feed</span>" /&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="8">
</td>
<td class="line-content">        <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://blog.tomtung.com/feed/atom.xml">http://blog.tomtung.com/feed/atom.xml</a>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">application/atom+xml</span>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">alternate</span>" <span class="html-attribute-name">title</span>="<span class="html-attribute-value">~/blog Atom Feed</span>" /&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="9">
</td>
<td class="line-content">        <span class="html-tag">&lt;link <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://blog.tomtung.com/feed/index.html">http://blog.tomtung.com/feed/index.html</a>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">application/rss+xml</span>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">alternate</span>" <span class="html-attribute-name">title</span>="<span class="html-attribute-value">~/blog RSS Feed</span>" /&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="10">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="11">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="12">
</td>
<td class="line-content">        <span class="html-comment">&lt;!-- Mobile viewport optimized: j.mp/bplateviewport --&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="13">
</td>
<td class="line-content">        <span class="html-tag">&lt;meta <span class="html-attribute-name">name</span>="<span class="html-attribute-value">viewport</span>" <span class="html-attribute-name">content</span>="<span class="html-attribute-value">width=device-width,initial-scale=1, maximum-scale=1</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="14">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="15">
</td>
<td class="line-content">        <span class="html-tag">&lt;link <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">stylesheet</span>" <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/css</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://blog.tomtung.com/theme/css/gumby.css">http://blog.tomtung.com/theme/css/gumby.css</a>" /&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="16">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="17">
</td>
<td class="line-content">        <span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://blog.tomtung.com/theme/js/libs/modernizr-2.6.2.min.js">http://blog.tomtung.com/theme/js/libs/modernizr-2.6.2.min.js</a>"&gt;</span>
<span class="html-tag">&lt;/script&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="18">
</td>
<td class="line-content">        <span class="html-tag">&lt;script <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/javascript</span>"</span>
</td>
</tr>
<tr>
<td class="line-number" value="19">
</td>
<td class="line-content">                <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML</a>"&gt;<span class="html-tag">&lt;/script&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="20">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="21">
</td>
<td class="line-content">            <span class="html-tag">&lt;script <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/javascript</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="22">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="23">
</td>
<td class="line-content">              var _gaq = _gaq || [];</td>
</tr>
<tr>
<td class="line-number" value="24">
</td>
<td class="line-content">              _gaq.push(['_setAccount', 'UA-12852556-1']);</td>
</tr>
<tr>
<td class="line-number" value="25">
</td>
<td class="line-content">              _gaq.push(['_trackPageview']);</td>
</tr>
<tr>
<td class="line-number" value="26">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="27">
</td>
<td class="line-content">              (function() {</td>
</tr>
<tr>
<td class="line-number" value="28">
</td>
<td class="line-content">                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;</td>
</tr>
<tr>
<td class="line-number" value="29">
</td>
<td class="line-content">                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';</td>
</tr>
<tr>
<td class="line-number" value="30">
</td>
<td class="line-content">                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);</td>
</tr>
<tr>
<td class="line-number" value="31">
</td>
<td class="line-content">              })();</td>
</tr>
<tr>
<td class="line-number" value="32">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="33">
</td>
<td class="line-content">            <span class="html-tag">&lt;/script&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="34">
</td>
<td class="line-content">
<span class="html-tag">&lt;/head&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="35">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="36">
</td>
<td class="line-content">
<span class="html-tag">&lt;body <span class="html-attribute-name">id</span>="<span class="html-attribute-value">index</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">home</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="37">
</td>
<td class="line-content">  <span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">navigation</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">navbar</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="38">
</td>
<td class="line-content">    <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/2011/10/em-algorithm/#">#</a>" <span class="html-attribute-name">gumby-trigger</span>="<span class="html-attribute-value">#navigation &amp;gt; ul</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">toggle</span>"&gt;</span>
<span class="html-tag">&lt;i <span class="html-attribute-name">class</span>="<span class="html-attribute-value">icon-menu</span>"&gt;</span>
<span class="html-tag">&lt;/i&gt;</span>
<span class="html-tag">&lt;/a&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="39">
</td>
<td class="line-content">    <span class="html-tag">&lt;span <span class="html-attribute-name">id</span>="<span class="html-attribute-value">navbar-title</span>"&gt;</span>
<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/">http://blog.tomtung.com</a>"&gt;</span> ~/blog <span class="html-tag">&lt;/a&gt;</span>
<span class="html-tag">&lt;/span&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="40">
</td>
<td class="line-content">    <span class="html-tag">&lt;ul <span class="html-attribute-name">id</span>="<span class="html-attribute-value">navbar-items</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="41">
</td>
<td class="line-content">        <span class="html-tag">&lt;li &gt;</span>
<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/archive">http://blog.tomtung.com/archive</a>"&gt;</span>Archive<span class="html-tag">&lt;/a&gt;</span>
<span class="html-tag">&lt;/li&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="42">
</td>
<td class="line-content">        <span class="html-tag">&lt;li &gt;</span>
<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/tags">http://blog.tomtung.com/tags</a>"&gt;</span>Tags<span class="html-tag">&lt;/a&gt;</span>
<span class="html-tag">&lt;/li&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="43">
</td>
<td class="line-content">      </td>
</tr>
<tr>
<td class="line-number" value="44">
</td>
<td class="line-content">        <span class="html-tag">&lt;li&gt;</span>
<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/feed/atom.xml">http://blog.tomtung.com/feed/atom.xml</a>"&gt;</span>Feed<span class="html-tag">&lt;/a&gt;</span>
<span class="html-tag">&lt;/li&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="45">
</td>
<td class="line-content">    <span class="html-tag">&lt;/ul&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="46">
</td>
<td class="line-content">  <span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="47">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="48">
</td>
<td class="line-content">  <span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">content-container</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">container</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="49">
</td>
<td class="line-content">
<span class="html-tag">&lt;section <span class="html-attribute-name">id</span>="<span class="html-attribute-value">content</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">body</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="50">
</td>
<td class="line-content">  <span class="html-tag">&lt;header <span class="html-attribute-name">class</span>="<span class="html-attribute-value">post-header</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="51">
</td>
<td class="line-content">    <span class="html-tag">&lt;div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="52">
</td>
<td class="line-content">      <span class="html-tag">&lt;time <span class="html-attribute-name">datetime</span>="<span class="html-attribute-value">2011-10-13T00:54:00</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="53">
</td>
<td class="line-content">        2011-10-13</td>
</tr>
<tr>
<td class="line-number" value="54">
</td>
<td class="line-content">      <span class="html-tag">&lt;/time&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="55">
</td>
<td class="line-content">    <span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="56">
</td>
<td class="line-content">    <span class="html-tag">&lt;h2 <span class="html-attribute-name">class</span>="<span class="html-attribute-value">entry-title</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="57">
</td>
<td class="line-content">      <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/2011/10/em-algorithm/">http://blog.tomtung.com/2011/10/em-algorithm/</a>" <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">bookmark</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="58">
</td>
<td class="line-content">        Expectation-Maximization(<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span>)&amp;nbsp;算法</td>
</tr>
<tr>
<td class="line-number" value="59">
</td>
<td class="line-content">      <span class="html-tag">&lt;/a&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="60">
</td>
<td class="line-content">    <span class="html-tag">&lt;/h2&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="61">
</td>
<td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">tag-row</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="62">
</td>
<td class="line-content">        <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">tag-row-icon</span>"&gt;</span>
<span class="html-tag">&lt;i <span class="html-attribute-name">class</span>="<span class="html-attribute-value">icon-tag</span>"&gt;</span>
<span class="html-tag">&lt;/i&gt;</span>
<span class="html-tag">&lt;/span&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="63">
</td>
<td class="line-content">          <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">small default oval btn</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="64">
</td>
<td class="line-content">            <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/tag/statistics.html">http://blog.tomtung.com/tag/statistics.html</a>"&gt;</span>statistics<span class="html-tag">&lt;/a&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="65">
</td>
<td class="line-content">          <span class="html-tag">&lt;/span&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="66">
</td>
<td class="line-content">          <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">small default oval btn</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="67">
</td>
<td class="line-content">            <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/tag/algorithm.html">http://blog.tomtung.com/tag/algorithm.html</a>"&gt;</span>algorithm<span class="html-tag">&lt;/a&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="68">
</td>
<td class="line-content">          <span class="html-tag">&lt;/span&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="69">
</td>
<td class="line-content">          <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">small default oval btn</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="70">
</td>
<td class="line-content">            <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/tag/machine-learning.html">http://blog.tomtung.com/tag/machine-learning.html</a>"&gt;</span>machine learning<span class="html-tag">&lt;/a&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="71">
</td>
<td class="line-content">          <span class="html-tag">&lt;/span&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="72">
</td>
<td class="line-content">    <span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="73">
</td>
<td class="line-content">   </td>
</tr>
<tr>
<td class="line-number" value="74">
</td>
<td class="line-content">  <span class="html-tag">&lt;/header&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="75">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="76">
</td>
<td class="line-content">  <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">post-content</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="77">
</td>
<td class="line-content">    <span class="html-tag">&lt;p&gt;</span>Expectation-Maximization 算法是统计学中用来给带<span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">reference external</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://en.wikipedia.org/wiki/Latent_variable">http://en.wikipedia.org/wiki/Latent_variable</a>"&gt;</span>隐含变量<span class="html-tag">&lt;/a&gt;</span>的模型做最大似然（和最大后验概率）的一种方法。<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span> 的应用特别广泛，经典的比如做概率密度估计用的 <span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">reference external</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://en.wikipedia.org/wiki/Gaussian_mixture_model">http://en.wikipedia.org/wiki/Gaussian_mixture_model</a>"&gt;</span>Gaussian Mixture Model<span class="html-tag">&lt;/a&gt;</span>。这两天我或许还会写 p 的笔记放上来，也是 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;应用的例子。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="78">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>下面我会先解释 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;算法要解决的问题，然后直接给出算法的过程，最后再说明算法的正确性。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="79">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">section</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">id1</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="80">
</td>
<td class="line-content">
<span class="html-tag">&lt;h2&gt;</span>问题<span class="html-tag">&lt;/h2&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="81">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>首先我们定义要解决的问题。给定一个训练集 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(X=\{x^{(1)},&amp;#8230;,x^{(m)}\}\)<span class="html-tag">&lt;/span&gt;</span>，我们希望拟合包含隐含变量 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(z\)<span class="html-tag">&lt;/span&gt;</span> 的模型 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(P(x,z;\theta)\)<span class="html-tag">&lt;/span&gt;</span> 中的参数 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span>。根据模型的假设，每个我们观察到的 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(x^{(i)}\)<span class="html-tag">&lt;/span&gt;</span> 还对应着一个我们观察不到的隐含变量 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(z^{(i)}\)<span class="html-tag">&lt;/span&gt;</span>，我们记 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Z=\{z^{(1)},&amp;#8230;,z^{(m)}\}\)<span class="html-tag">&lt;/span&gt;</span>。做最大对数似然就是要求 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;的“最优值”：<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="82">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="83">
</td>
<td class="line-content">\begin{equation*}</td>
</tr>
<tr>
<td class="line-number" value="84">
</td>
<td class="line-content">\theta=\arg\max_\theta{L(\theta;X)}</td>
</tr>
<tr>
<td class="line-number" value="85">
</td>
<td class="line-content">\end{equation*}</td>
</tr>
<tr>
<td class="line-number" value="86">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="87">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>其中<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="88">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="89">
</td>
<td class="line-content">\begin{equation*}</td>
</tr>
<tr>
<td class="line-number" value="90">
</td>
<td class="line-content">L(\theta;X)=log{P(X;\theta)}=\log{\sum_Z P(X,Z;\theta)}</td>
</tr>
<tr>
<td class="line-number" value="91">
</td>
<td class="line-content">\end{equation*}</td>
</tr>
<tr>
<td class="line-number" value="92">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="93">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>想用这个 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\log\)<span class="html-tag">&lt;/span&gt;</span> 套 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\sum\)<span class="html-tag">&lt;/span&gt;</span> 的形式直接求解 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 往往非常困难。而如果能观察到隐含变量 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(z\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;，求下面的似然函数的极大值会容易许多：<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="94">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="95">
</td>
<td class="line-content">\begin{equation*}</td>
</tr>
<tr>
<td class="line-number" value="96">
</td>
<td class="line-content">L(\theta;X,Z)=\log{P(X, Z;\theta)}</td>
</tr>
<tr>
<td class="line-number" value="97">
</td>
<td class="line-content">\end{equation*}</td>
</tr>
<tr>
<td class="line-number" value="98">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="99">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>问题是实际上我们没法观察到 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(z\)<span class="html-tag">&lt;/span&gt;</span> 的值，只能在给定 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 时求 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(z\)<span class="html-tag">&lt;/span&gt;</span> 的后验概率 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(P(z|x;\theta)\)<span class="html-tag">&lt;/span&gt;</span> 。  <span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">footnote-reference</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/2011/10/em-algorithm/#id8">#id8</a>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">id2</span>"&gt;</span>[1]<span class="html-tag">&lt;/a&gt;</span> <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;算法就可以帮我们打破这样的困境。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="100">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="101">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">section</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">id3</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="102">
</td>
<td class="line-content">
<span class="html-tag">&lt;h2&gt;</span>算法<span class="html-tag">&lt;/h2&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="103">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>下面给出 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span> 算法的过程。其中 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span> 是第 t-1 次迭代时算出的 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 值；<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_0\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;为任意初值。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="104">
</td>
<td class="line-content">
<span class="html-tag">&lt;blockquote&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="105">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>Repeat until converge&amp;nbsp;{<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="106">
</td>
<td class="line-content">
<span class="html-tag">&lt;blockquote&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="107">
</td>
<td class="line-content">
<span class="html-tag">&lt;ol <span class="html-attribute-name">class</span>="<span class="html-attribute-value">arabic</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="108">
</td>
<td class="line-content">
<span class="html-tag">&lt;li&gt;</span>
<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">first</span>"&gt;</span>(E-step) 计算 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(P(Z|X;\theta_t)\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;以得到<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="109">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="110">
</td>
<td class="line-content">\begin{align*}</td>
</tr>
<tr>
<td class="line-number" value="111">
</td>
<td class="line-content">E_{Z|X;\theta_t}[L(\theta;X,Z)]</td>
</tr>
<tr>
<td class="line-number" value="112">
</td>
<td class="line-content">&amp;amp;:= E_{Z|X;\theta_t}[\log{P(X,Z;\theta)}] &amp;#92;&amp;#92;</td>
</tr>
<tr>
<td class="line-number" value="113">
</td>
<td class="line-content">&amp;amp;= \sum_Z P(Z|X;\theta_t) \log{P(X,Z;\theta)}</td>
</tr>
<tr>
<td class="line-number" value="114">
</td>
<td class="line-content">\end{align*}</td>
</tr>
<tr>
<td class="line-number" value="115">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="116">
</td>
<td class="line-content">
<span class="html-tag">&lt;/li&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="117">
</td>
<td class="line-content">
<span class="html-tag">&lt;li&gt;</span>
<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">first</span>"&gt;</span>(M-step)<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="118">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="119">
</td>
<td class="line-content">\begin{equation*}</td>
</tr>
<tr>
<td class="line-number" value="120">
</td>
<td class="line-content">\theta_{t+1} := \arg\max_\theta E_{Z|X;\theta_t}[\log{P(X,Z;\theta)}]</td>
</tr>
<tr>
<td class="line-number" value="121">
</td>
<td class="line-content">\end{equation*}</td>
</tr>
<tr>
<td class="line-number" value="122">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="123">
</td>
<td class="line-content">
<span class="html-tag">&lt;/li&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="124">
</td>
<td class="line-content">
<span class="html-tag">&lt;/ol&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="125">
</td>
<td class="line-content">
<span class="html-tag">&lt;/blockquote&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="126">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>}<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="127">
</td>
<td class="line-content">
<span class="html-tag">&lt;/blockquote&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="128">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>对，就这么短。所以我总觉得称之为 algorithm 不如称之为 method 更恰当。上面的过程在收敛后就得到了我们需要的 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta=\arg\max_\theta{L(\theta;X)}\)<span class="html-tag">&lt;/span&gt;</span>  <span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">footnote-reference</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/2011/10/em-algorithm/#id9">#id9</a>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">id4</span>"&gt;</span>[2]<span class="html-tag">&lt;/a&gt;</span>。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="129">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>先简单说说这短短两步都做了些啥。<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span> 算法每次迭代都建立在上轮迭代对 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 的最优值的估计 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span> 上，利用它可以求出 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Z\)<span class="html-tag">&lt;/span&gt;</span> 的后验概率 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(P(Z|X;\theta_t)\)<span class="html-tag">&lt;/span&gt;</span> ，进而求出 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(L(\theta;X,Z)\)<span class="html-tag">&lt;/span&gt;</span> 在分布 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Z \sim P(Z|X;\theta)\)<span class="html-tag">&lt;/span&gt;</span> 上的期望 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(E_{Z|X;\theta_t}[L(\theta;X,Z)]\)<span class="html-tag">&lt;/span&gt;</span>。在第一节中我们提到 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\arg\max_\theta L(\theta;X,Z)\)<span class="html-tag">&lt;/span&gt;</span> 在未知 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Z\)<span class="html-tag">&lt;/span&gt;</span> 的情况下难以直接计算，于是 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span> 算法就转而通过最大化它的期望 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(E_{Z|X;\theta_t}[L(\theta;X,Z)]\)<span class="html-tag">&lt;/span&gt;</span> 来逼近 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 的最优值，得到 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_{t+1}\)<span class="html-tag">&lt;/span&gt;</span> 。注意由于 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(L(\theta;X,Z)\)<span class="html-tag">&lt;/span&gt;</span> 的这个期望是在 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Z\)<span class="html-tag">&lt;/span&gt;</span> 的一个分布上求的，这样得到的表达式就只剩下 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 一个未知量，因而绕过了 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(z\)<span class="html-tag">&lt;/span&gt;</span> 未知的问题。而 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_{t+1}\)<span class="html-tag">&lt;/span&gt;</span> 又可以作为下轮迭代的基础，继续向最优逼近。算法中 E-step 就是在利用 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span> 求期望 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(E_{Z|X;\theta_t}[L(\theta;X,Z)]\)<span class="html-tag">&lt;/span&gt;</span>，这就是所谓“Expectation”；M-step 就是通过寻找 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_{t+1}\)<span class="html-tag">&lt;/span&gt;</span> 最大化这个期望来逼近 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 的最优值，这就叫“Maximization”。<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;算法因此得名。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="130">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>另外，如果数据满足独立同分布的条件，分别枚举 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(z^{(i)}\)<span class="html-tag">&lt;/span&gt;</span> 的值可能要比枚举整个 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Z\)<span class="html-tag">&lt;/span&gt;</span> 方便些，可把 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(E_{Z|X;\theta_t}[L(\theta;X,Z)]\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;替换成：<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="131">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="132">
</td>
<td class="line-content">\begin{align*}</td>
</tr>
<tr>
<td class="line-number" value="133">
</td>
<td class="line-content">\sum_i E_{z^{(i)}|x^{(i)};\theta_t}[L(\theta;x^{(i)},z^{(i)}]</td>
</tr>
<tr>
<td class="line-number" value="134">
</td>
<td class="line-content">&amp;amp;:= \sum_i E_{z^{(i)}|x^{(i)};\theta_t}[\log{P(x^{(i)},z^{(i)};\theta)}] &amp;#92;&amp;#92;</td>
</tr>
<tr>
<td class="line-number" value="135">
</td>
<td class="line-content">&amp;amp;= \sum_i \sum_{z^{(i)}} P(z^{(i)}|x^{(i)};\theta_t) \log{P(x^{(i)},z^{(i)};\theta)}</td>
</tr>
<tr>
<td class="line-number" value="136">
</td>
<td class="line-content">\end{align*}</td>
</tr>
<tr>
<td class="line-number" value="137">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="138">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="139">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">section</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">id5</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="140">
</td>
<td class="line-content">
<span class="html-tag">&lt;h2&gt;</span>原理<span class="html-tag">&lt;/h2&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="141">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>为什么这样 E一步，M一步，一步E，一步M，就能逼近极大似然？具体而言，为什么通过迭代计算 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\arg\max_\theta E_{Z|X;\theta_t}[L(\theta;X,Z)]\)<span class="html-tag">&lt;/span&gt;</span> 可以逼近 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 的最优值 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\arg\max_\theta L(\theta;X,Z)\)<span class="html-tag">&lt;/span&gt;</span>？我们稍后会看到，这是因为每次迭代得到的 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_{t+1}\)<span class="html-tag">&lt;/span&gt;</span> 一定比 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span> 更优，即算法是在对 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;的最优值做单调逼近。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="142">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>不过首先让我们先抛开最大似然，考虑一个更一般的问题。假设有一个凹函数 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(F(\theta)\)<span class="html-tag">&lt;/span&gt;</span> ，我们想求 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\arg\max_\theta F(\theta)\)<span class="html-tag">&lt;/span&gt;</span> ，但直接求很困难。不过对于任意给定的 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span>，假设我们都能找到 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(F(\theta)\)<span class="html-tag">&lt;/span&gt;</span> 的一个下界函数 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(G_{\theta_t}(\theta)\)<span class="html-tag">&lt;/span&gt;</span>，满足 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(F(\theta) \geq G_{\theta_t}(\theta)\)<span class="html-tag">&lt;/span&gt;</span> 且 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(F(\theta_t) = G_{\theta_t}(\theta_t)\)<span class="html-tag">&lt;/span&gt;</span> ——我管 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(G_{\theta_t}(\theta)\)<span class="html-tag">&lt;/span&gt;</span> 这样的函数叫 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(F\)<span class="html-tag">&lt;/span&gt;</span> 的“在 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span> 处相等的下界函数”。现在考虑 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_{t+1} := \arg\max_\theta G_{\theta_t}(\theta)\)<span class="html-tag">&lt;/span&gt;</span>，它一定会满足：<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="143">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="144">
</td>
<td class="line-content">\begin{equation*}</td>
</tr>
<tr>
<td class="line-number" value="145">
</td>
<td class="line-content">F(\theta_{t+1}) \geq G_{\theta_t}(\theta_{t+1}) \geq G_{\theta_t}(\theta_t) = F(\theta_t)</td>
</tr>
<tr>
<td class="line-number" value="146">
</td>
<td class="line-content">\end{equation*}</td>
</tr>
<tr>
<td class="line-number" value="147">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="148">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>也就是说， <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_{t+1}\)<span class="html-tag">&lt;/span&gt;</span> 一定比 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span> 更优。而接下来我们又可以用 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_{t+1}\)<span class="html-tag">&lt;/span&gt;</span> 找到一个 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(G_{\theta_{t+1}}(\theta)\)<span class="html-tag">&lt;/span&gt;</span>，再据此算出比 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_{t+1}\)<span class="html-tag">&lt;/span&gt;</span> 还优的 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_{t+2} := \arg\max_\theta G_{\theta_{t+1}}(\theta)\)<span class="html-tag">&lt;/span&gt;</span> 。如此不断迭代，就能不断步步逼近 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 的最优值了。由此可见，如果对任意 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span> 都能找到 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(F\)<span class="html-tag">&lt;/span&gt;</span> 的“在 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span> 处相等的下界函数” <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(G_{\theta_t}(\theta)\)<span class="html-tag">&lt;/span&gt;</span>，我们就得到了一个能单调逼近 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;的最优值的算法：<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="149">
</td>
<td class="line-content">
<span class="html-tag">&lt;blockquote&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="150">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>Repeat until converge&amp;nbsp;{<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="151">
</td>
<td class="line-content">
<span class="html-tag">&lt;blockquote&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="152">
</td>
<td class="line-content">
<span class="html-tag">&lt;ol <span class="html-attribute-name">class</span>="<span class="html-attribute-value">arabic</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="153">
</td>
<td class="line-content">
<span class="html-tag">&lt;li&gt;</span>
<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">first</span>"&gt;</span>找到函数 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(F(\theta)\)<span class="html-tag">&lt;/span&gt;</span> 的“在 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span> 处相等的下界函数” <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(G_{\theta_t}(\theta)\)<span class="html-tag">&lt;/span&gt;</span>
<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="154">
</td>
<td class="line-content">
<span class="html-tag">&lt;/li&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="155">
</td>
<td class="line-content">
<span class="html-tag">&lt;li&gt;</span>
<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">first</span>"&gt;</span>更新参数<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="156">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="157">
</td>
<td class="line-content">\begin{equation*}</td>
</tr>
<tr>
<td class="line-number" value="158">
</td>
<td class="line-content">\theta_{t+1} := \arg\max_\theta G_{\theta_t}(\theta)</td>
</tr>
<tr>
<td class="line-number" value="159">
</td>
<td class="line-content">\end{equation*}</td>
</tr>
<tr>
<td class="line-number" value="160">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="161">
</td>
<td class="line-content">
<span class="html-tag">&lt;/li&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="162">
</td>
<td class="line-content">
<span class="html-tag">&lt;/ol&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="163">
</td>
<td class="line-content">
<span class="html-tag">&lt;/blockquote&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="164">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>}<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="165">
</td>
<td class="line-content">
<span class="html-tag">&lt;/blockquote&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="166">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>上面的算法看起来和 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span> 算法的每步都分别对应——事实上也正如此。下面是从 <span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">reference external</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://research.microsoft.com/en-us/um/people/cmbishop/prml/">http://research.microsoft.com/en-us/um/people/cmbishop/prml/</a>"&gt;</span>
<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>PRML<span class="html-tag">&lt;/span&gt;</span>
<span class="html-tag">&lt;/a&gt;</span>&amp;nbsp;中偷的一张图改的，展示了上述逼近的过程：<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="167">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>
<span class="html-tag">&lt;img <span class="html-attribute-name">alt</span>="<span class="html-attribute-value">image0</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://blog.tomtung.com/images/2011-10-13-em-algo.png">/images/2011-10-13-em-algo.png</a>" /&gt;</span>
<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="168">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>现在我们回到最大似然问题 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta=\arg\max_\theta{L(\theta;X)}\)<span class="html-tag">&lt;/span&gt;</span> 。如果我们想套用上面的算法来逼近 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 的这个最优解，就需要找到对于每个 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span>，函数 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(L(\theta;X)\)<span class="html-tag">&lt;/span&gt;</span> 的“在 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span> 处相等的下界函数”。该怎么找呢？让我们从 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(L(\theta)\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;的初始形式开始推导：<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="169">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="170">
</td>
<td class="line-content">\begin{align*}</td>
</tr>
<tr>
<td class="line-number" value="171">
</td>
<td class="line-content">L(\theta)</td>
</tr>
<tr>
<td class="line-number" value="172">
</td>
<td class="line-content">&amp;amp;= \log{P(X;\theta)} &amp;#92;&amp;#92;</td>
</tr>
<tr>
<td class="line-number" value="173">
</td>
<td class="line-content">&amp;amp;= \log{\sum_Z P(X,Z;\theta)}</td>
</tr>
<tr>
<td class="line-number" value="174">
</td>
<td class="line-content">\end{align*}</td>
</tr>
<tr>
<td class="line-number" value="175">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="176">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>又卡在这个 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\log\)<span class="html-tag">&lt;/span&gt;</span> 套 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\sum\)<span class="html-tag">&lt;/span&gt;</span> 的形式上了……我们说过麻烦在于观察不到 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Z\)<span class="html-tag">&lt;/span&gt;</span> 的值，那不妨给它任意引入一个概率分布 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Q(Z)\)<span class="html-tag">&lt;/span&gt;</span>  <span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">footnote-reference</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/2011/10/em-algorithm/#id10">#id10</a>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">id6</span>"&gt;</span>[3]<span class="html-tag">&lt;/a&gt;</span>，利用分子分母同乘 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Q(Z)\)<span class="html-tag">&lt;/span&gt;</span> 的小&amp;nbsp;trick，得到：<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="177">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="178">
</td>
<td class="line-content">\begin{align*}</td>
</tr>
<tr>
<td class="line-number" value="179">
</td>
<td class="line-content">L(\theta)</td>
</tr>
<tr>
<td class="line-number" value="180">
</td>
<td class="line-content">&amp;amp;= \log{\sum_Z P(X,Z;\theta)} &amp;#92;&amp;#92;</td>
</tr>
<tr>
<td class="line-number" value="181">
</td>
<td class="line-content">&amp;amp;= \log{\sum_Z Q(Z) \frac{P(X,Z;\theta)}{Q(Z)}} &amp;#92;&amp;#92;</td>
</tr>
<tr>
<td class="line-number" value="182">
</td>
<td class="line-content">&amp;amp;= \log E_{Z \sim Q}\left[ \frac{P(X,Z;\theta)}{Q(Z)} \right]</td>
</tr>
<tr>
<td class="line-number" value="183">
</td>
<td class="line-content">\end{align*}</td>
</tr>
<tr>
<td class="line-number" value="184">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="185">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>根据 Jensen 不等式  <span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">footnote-reference</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/2011/10/em-algorithm/#id11">#id11</a>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">id7</span>"&gt;</span>[4]<span class="html-tag">&lt;/a&gt;</span>，对于任意分布 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Q\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;都有：<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="186">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="187">
</td>
<td class="line-content">\begin{equation*}</td>
</tr>
<tr>
<td class="line-number" value="188">
</td>
<td class="line-content">L(\theta) = \log E_{Z \sim Q}\left[ \frac{P(X,Z;\theta)}{Q(Z)} \right] \geq E_{Z \sim Q}\left[ \log\frac{P(X,Z;\theta)}{Q(Z)} \right]</td>
</tr>
<tr>
<td class="line-number" value="189">
</td>
<td class="line-content">\end{equation*}</td>
</tr>
<tr>
<td class="line-number" value="190">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="191">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>且上面的不等式在 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\frac {P(X,Z;\theta)} {Q(Z)}\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;为常数时取等号。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="192">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>于是我们就得到了 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(L(\theta;X)\)<span class="html-tag">&lt;/span&gt;</span> 的一个下界函数。我们要想套用上面的算法，还要让这个不等式在 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span> 处取等号，这就这要求在 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta = \theta_t\)<span class="html-tag">&lt;/span&gt;</span> 时 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\frac {P(X,Z;\theta)} {Q(Z)}\)<span class="html-tag">&lt;/span&gt;</span> 为常数，即 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Q(Z) \propto P(X,Z;\theta_t)\)<span class="html-tag">&lt;/span&gt;</span>。由于 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Q(Z)\)<span class="html-tag">&lt;/span&gt;</span> 是一个概率分布，必须满足 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\sum_z Q_i(z) = 1\)<span class="html-tag">&lt;/span&gt;</span>，所以这样的 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Q(Z)\)<span class="html-tag">&lt;/span&gt;</span> 只能是 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Q(Z) = \frac {P(X,Z;\theta_t)} {\sum_Z P(X,Z;\theta_t)} = P(Z|X;\theta_t)\)<span class="html-tag">&lt;/span&gt;</span>。那我们就把 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Q(Z) = P(Z|X;\theta_t)\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;代入上式，得到：<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="193">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="194">
</td>
<td class="line-content">\begin{equation*}</td>
</tr>
<tr>
<td class="line-number" value="195">
</td>
<td class="line-content">L(\theta) \geq E_{Z|X;\theta_t}\left[ \log\frac{P(X,Z;\theta)}{P(Z|X;\theta_t)} \right]</td>
</tr>
<tr>
<td class="line-number" value="196">
</td>
<td class="line-content">\end{equation*}</td>
</tr>
<tr>
<td class="line-number" value="197">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="198">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>且该不等式在 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta = \theta_t\)<span class="html-tag">&lt;/span&gt;</span> 时取到等号。那么…… <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(E_{Z|X;\theta_t}\left[ \log\frac{P(X,Z;\theta)}{P(Z|X;\theta_t)} \right]\)<span class="html-tag">&lt;/span&gt;</span> 就是 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(L(\theta;X)\)<span class="html-tag">&lt;/span&gt;</span> 的“在 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span> 处相等的下界函数”——这不就是我们要找的么！于是把它塞进本节开始得到的算法里替换“ <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(G_{\theta_t}(\theta)\)<span class="html-tag">&lt;/span&gt;</span> ”就可以用啦。也就是说，迭代计算 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\arg\max_\theta E_{Z|X;\theta_t}\left[ \log\frac{P(X,Z;\theta)}{P(Z|X;\theta_t)} \right]\)<span class="html-tag">&lt;/span&gt;</span>就可以逼近 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 的最优值了。而由于利用 Jensen 不等式的那一步搞掉了<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\log\)<span class="html-tag">&lt;/span&gt;</span>套<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\sum\)<span class="html-tag">&lt;/span&gt;</span>的形式，它算起来往往要比直接算 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\arg\max_\theta{L(\theta;X)}\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;容易不少。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="199">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>我们还可以再做几步推导，得到一个更简单的形式：<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="200">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="201">
</td>
<td class="line-content">\begin{align*}</td>
</tr>
<tr>
<td class="line-number" value="202">
</td>
<td class="line-content">\theta_{t+1}</td>
</tr>
<tr>
<td class="line-number" value="203">
</td>
<td class="line-content">&amp;amp;:= \arg\max_\theta E_{Z|X;\theta_t}\left[ \log\frac{P(X,Z;\theta)}{P(Z|X;\theta_t)} \right] &amp;#92;&amp;#92;</td>
</tr>
<tr>
<td class="line-number" value="204">
</td>
<td class="line-content">&amp;amp;\equiv \arg\max_\theta \sum_{Z} P(Z|X;\theta_t) \log\frac{P(X,Z;\theta)}{P(Z|X;\theta_t)} &amp;#92;&amp;#92;</td>
</tr>
<tr>
<td class="line-number" value="205">
</td>
<td class="line-content">&amp;amp;= \arg\max_\theta \sum_{Z} [P(Z|X;\theta_t)\log P(X,Z;\theta) - P(Z|X;\theta_t) \log P(Z|X;\theta_t)] &amp;#92;&amp;#92;</td>
</tr>
<tr>
<td class="line-number" value="206">
</td>
<td class="line-content">&amp;amp;= \arg\max_\theta \sum_{Z} P(Z|X;\theta_t)\log P(X,Z;\theta) &amp;#92;&amp;#92;</td>
</tr>
<tr>
<td class="line-number" value="207">
</td>
<td class="line-content">&amp;amp;\equiv \arg\max_\theta E_{Z|X;\theta_t}[\log{P(X,Z;\theta)}]</td>
</tr>
<tr>
<td class="line-number" value="208">
</td>
<td class="line-content">\end{align*}</td>
</tr>
<tr>
<td class="line-number" value="209">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="210">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>其中倒数第二步是因为 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(- P(Z|X;\theta_t) \log P(Z|X;\theta_t)]\)<span class="html-tag">&lt;/span&gt;</span> 这一项与 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 无关，所以就直接扔掉了。这样就得到了本文第二节 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;算法中的形式——它就是这么来的。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="211">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>以上就是 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;了。至于独立同分布的情况推导也类似。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="212">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>顺带一提，<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\arg\max_\theta E_{Z|X;\theta_t}[\log{P(X,Z;\theta)}]\)<span class="html-tag">&lt;/span&gt;</span> 有时也比较难算。这时我们其实可以退而求其次，不要求这个期望最大化了，只要它在 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_{t+1}\)<span class="html-tag">&lt;/span&gt;</span> 处的值大于在 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_t\)<span class="html-tag">&lt;/span&gt;</span> 处的值就行了。根据上面的推导，这样也能逼近 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 的最优值，只是收敛速度较慢。这就是所谓 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>GEM<span class="html-tag">&lt;/span&gt;</span> (Generalized <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span>)&amp;nbsp;算法了。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="213">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>p.s. <span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">reference external</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.mathjax.org/">http://www.mathjax.org/</a>"&gt;</span>MathJax<span class="html-tag">&lt;/a&gt;</span>&amp;nbsp;很神嘛。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="214">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>p.p.s. 这篇笔记竟然断断续续写写改改了两天多，我对 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">caps</span>"&gt;</span>EM<span class="html-tag">&lt;/span&gt;</span> 的认识也越来越清晰。“<span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">reference external</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://mindhacks.cn/2009/02/15/why-you-should-start-blogging-now/">http://mindhacks.cn/2009/02/15/why-you-should-start-blogging-now/</a>"&gt;</span>‘教’是最好的‘学’<span class="html-tag">&lt;/a&gt;</span>”真是一点没错。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="215">
</td>
<td class="line-content">
<span class="html-tag">&lt;table <span class="html-attribute-name">class</span>="<span class="html-attribute-value">docutils footnote</span>" <span class="html-attribute-name">frame</span>="<span class="html-attribute-value">void</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">id8</span>" <span class="html-attribute-name">rules</span>="<span class="html-attribute-value">none</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="216">
</td>
<td class="line-content">
<span class="html-tag">&lt;colgroup&gt;</span>
<span class="html-tag">&lt;col <span class="html-attribute-name">class</span>="<span class="html-attribute-value">label</span>" /&gt;</span>
<span class="html-tag">&lt;col /&gt;</span>
<span class="html-tag">&lt;/colgroup&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="217">
</td>
<td class="line-content">
<span class="html-tag">&lt;tbody <span class="html-attribute-name">valign</span>="<span class="html-attribute-value">top</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="218">
</td>
<td class="line-content">
<span class="html-tag">&lt;tr&gt;</span>
<span class="html-tag">&lt;td <span class="html-attribute-name">class</span>="<span class="html-attribute-value">label</span>"&gt;</span>
<span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fn-backref</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/2011/10/em-algorithm/#id2">#id2</a>"&gt;</span>[1]<span class="html-tag">&lt;/a&gt;</span>
<span class="html-tag">&lt;/td&gt;</span>
<span class="html-tag">&lt;td&gt;</span>
<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">first</span>"&gt;</span>一般可以利用<span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">reference external</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://en.wikipedia.org/wiki/Bayes%27_theorem">http://en.wikipedia.org/wiki/Bayes%27_theorem</a>"&gt;</span>贝叶斯定理<span class="html-tag">&lt;/a&gt;</span>：<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="219">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="220">
</td>
<td class="line-content">\begin{equation*}</td>
</tr>
<tr>
<td class="line-number" value="221">
</td>
<td class="line-content">P(z|x;\theta) = \frac{P(x|z;\theta)P(z;\theta)}{\sum_z{P(x|z;\theta)P(z;\theta)}}</td>
</tr>
<tr>
<td class="line-number" value="222">
</td>
<td class="line-content">\end{equation*}</td>
</tr>
<tr>
<td class="line-number" value="223">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="224">
</td>
<td class="line-content">
<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">last</span>"&gt;</span>而 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(P(x|z;\theta)\)<span class="html-tag">&lt;/span&gt;</span> 和 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(P(z;\theta)\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;往往是模型假设的一部分。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="225">
</td>
<td class="line-content">
<span class="html-tag">&lt;/td&gt;</span>
<span class="html-tag">&lt;/tr&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="226">
</td>
<td class="line-content">
<span class="html-tag">&lt;/tbody&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="227">
</td>
<td class="line-content">
<span class="html-tag">&lt;/table&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="228">
</td>
<td class="line-content">
<span class="html-tag">&lt;table <span class="html-attribute-name">class</span>="<span class="html-attribute-value">docutils footnote</span>" <span class="html-attribute-name">frame</span>="<span class="html-attribute-value">void</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">id9</span>" <span class="html-attribute-name">rules</span>="<span class="html-attribute-value">none</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="229">
</td>
<td class="line-content">
<span class="html-tag">&lt;colgroup&gt;</span>
<span class="html-tag">&lt;col <span class="html-attribute-name">class</span>="<span class="html-attribute-value">label</span>" /&gt;</span>
<span class="html-tag">&lt;col /&gt;</span>
<span class="html-tag">&lt;/colgroup&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="230">
</td>
<td class="line-content">
<span class="html-tag">&lt;tbody <span class="html-attribute-name">valign</span>="<span class="html-attribute-value">top</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="231">
</td>
<td class="line-content">
<span class="html-tag">&lt;tr&gt;</span>
<span class="html-tag">&lt;td <span class="html-attribute-name">class</span>="<span class="html-attribute-value">label</span>"&gt;</span>
<span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fn-backref</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/2011/10/em-algorithm/#id4">#id4</a>"&gt;</span>[2]<span class="html-tag">&lt;/a&gt;</span>
<span class="html-tag">&lt;/td&gt;</span>
<span class="html-tag">&lt;td&gt;</span>实际上在某些特殊情况下，<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta\)<span class="html-tag">&lt;/span&gt;</span> 还可能收敛在局部最优点或鞍点上。这时可以多跑几次算法，每次随机不同的 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\theta_0\)<span class="html-tag">&lt;/span&gt;</span>，最后取最好的结果。为简明起见，本文忽略这种情况。<span class="html-tag">&lt;/td&gt;</span>
<span class="html-tag">&lt;/tr&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="232">
</td>
<td class="line-content">
<span class="html-tag">&lt;/tbody&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="233">
</td>
<td class="line-content">
<span class="html-tag">&lt;/table&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="234">
</td>
<td class="line-content">
<span class="html-tag">&lt;table <span class="html-attribute-name">class</span>="<span class="html-attribute-value">docutils footnote</span>" <span class="html-attribute-name">frame</span>="<span class="html-attribute-value">void</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">id10</span>" <span class="html-attribute-name">rules</span>="<span class="html-attribute-value">none</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="235">
</td>
<td class="line-content">
<span class="html-tag">&lt;colgroup&gt;</span>
<span class="html-tag">&lt;col <span class="html-attribute-name">class</span>="<span class="html-attribute-value">label</span>" /&gt;</span>
<span class="html-tag">&lt;col /&gt;</span>
<span class="html-tag">&lt;/colgroup&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="236">
</td>
<td class="line-content">
<span class="html-tag">&lt;tbody <span class="html-attribute-name">valign</span>="<span class="html-attribute-value">top</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="237">
</td>
<td class="line-content">
<span class="html-tag">&lt;tr&gt;</span>
<span class="html-tag">&lt;td <span class="html-attribute-name">class</span>="<span class="html-attribute-value">label</span>"&gt;</span>
<span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fn-backref</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/2011/10/em-algorithm/#id6">#id6</a>"&gt;</span>[3]<span class="html-tag">&lt;/a&gt;</span>
<span class="html-tag">&lt;/td&gt;</span>
<span class="html-tag">&lt;td&gt;</span>
<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Q(Z)\)<span class="html-tag">&lt;/span&gt;</span> 为概率分布，意即需满足 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\sum_Z Q(Z) = 1\)<span class="html-tag">&lt;/span&gt;</span> 且 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(Q(Z) \geq 0\)<span class="html-tag">&lt;/span&gt;</span>
<span class="html-tag">&lt;/td&gt;</span>
<span class="html-tag">&lt;/tr&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="238">
</td>
<td class="line-content">
<span class="html-tag">&lt;/tbody&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="239">
</td>
<td class="line-content">
<span class="html-tag">&lt;/table&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="240">
</td>
<td class="line-content">
<span class="html-tag">&lt;table <span class="html-attribute-name">class</span>="<span class="html-attribute-value">docutils footnote</span>" <span class="html-attribute-name">frame</span>="<span class="html-attribute-value">void</span>" <span class="html-attribute-name">id</span>="<span class="html-attribute-value">id11</span>" <span class="html-attribute-name">rules</span>="<span class="html-attribute-value">none</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="241">
</td>
<td class="line-content">
<span class="html-tag">&lt;colgroup&gt;</span>
<span class="html-tag">&lt;col <span class="html-attribute-name">class</span>="<span class="html-attribute-value">label</span>" /&gt;</span>
<span class="html-tag">&lt;col /&gt;</span>
<span class="html-tag">&lt;/colgroup&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="242">
</td>
<td class="line-content">
<span class="html-tag">&lt;tbody <span class="html-attribute-name">valign</span>="<span class="html-attribute-value">top</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="243">
</td>
<td class="line-content">
<span class="html-tag">&lt;tr&gt;</span>
<span class="html-tag">&lt;td <span class="html-attribute-name">class</span>="<span class="html-attribute-value">label</span>"&gt;</span>
<span class="html-tag">&lt;a <span class="html-attribute-name">class</span>="<span class="html-attribute-value">fn-backref</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://blog.tomtung.com/2011/10/em-algorithm/#id7">#id7</a>"&gt;</span>[4]<span class="html-tag">&lt;/a&gt;</span>
<span class="html-tag">&lt;/td&gt;</span>
<span class="html-tag">&lt;td&gt;</span>
<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">first</span>"&gt;</span>Jensen&amp;nbsp;不等式：<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="244">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>
<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(f\)<span class="html-tag">&lt;/span&gt;</span> 为凸函数，<span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(X\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;为随机变量。则<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="245">
</td>
<td class="line-content">
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="246">
</td>
<td class="line-content">\begin{equation*}</td>
</tr>
<tr>
<td class="line-number" value="247">
</td>
<td class="line-content">E[f(X)]\geq f(E[X])</td>
</tr>
<tr>
<td class="line-number" value="248">
</td>
<td class="line-content">\end{equation*}</td>
</tr>
<tr>
<td class="line-number" value="249">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="250">
</td>
<td class="line-content">
<span class="html-tag">&lt;p&gt;</span>若 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(f\)<span class="html-tag">&lt;/span&gt;</span> 是严格凸的，则上式取等号当前仅当 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(X\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;为常数。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="251">
</td>
<td class="line-content">
<span class="html-tag">&lt;p <span class="html-attribute-name">class</span>="<span class="html-attribute-value">last</span>"&gt;</span>在这里 <span class="html-tag">&lt;span <span class="html-attribute-name">class</span>="<span class="html-attribute-value">math</span>"&gt;</span>\(\log\)<span class="html-tag">&lt;/span&gt;</span>&amp;nbsp;函数是严格凹的，所以要把上面的不等号方向调转。<span class="html-tag">&lt;/p&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="252">
</td>
<td class="line-content">
<span class="html-tag">&lt;/td&gt;</span>
<span class="html-tag">&lt;/tr&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="253">
</td>
<td class="line-content">
<span class="html-tag">&lt;/tbody&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="254">
</td>
<td class="line-content">
<span class="html-tag">&lt;/table&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="255">
</td>
<td class="line-content">
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="256">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="257">
</td>
<td class="line-content">  <span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="258">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="259">
</td>
<td class="line-content">  <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">comments</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="260">
</td>
<td class="line-content">    <span class="html-tag">&lt;h3&gt;</span>Comments<span class="html-tag">&lt;/h3&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="261">
</td>
<td class="line-content">    <span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">disqus_thread</span>"&gt;</span>
<span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="262">
</td>
<td class="line-content">    <span class="html-tag">&lt;script <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/javascript</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="263">
</td>
<td class="line-content">      var disqus_identifier = "2011/10/em-algorithm/";</td>
</tr>
<tr>
<td class="line-number" value="264">
</td>
<td class="line-content">      (function() {</td>
</tr>
<tr>
<td class="line-number" value="265">
</td>
<td class="line-content">      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;</td>
</tr>
<tr>
<td class="line-number" value="266">
</td>
<td class="line-content">      dsq.src = 'http://tomtung.disqus.com/embed.js';</td>
</tr>
<tr>
<td class="line-number" value="267">
</td>
<td class="line-content">      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);</td>
</tr>
<tr>
<td class="line-number" value="268">
</td>
<td class="line-content">      })();</td>
</tr>
<tr>
<td class="line-number" value="269">
</td>
<td class="line-content">    <span class="html-tag">&lt;/script&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="270">
</td>
<td class="line-content">  <span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="271">
</td>
<td class="line-content">
<span class="html-tag">&lt;/section&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="272">
</td>
<td class="line-content">  <span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="273">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="274">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="275">
</td>
<td class="line-content">   <span class="html-tag">&lt;div <span class="html-attribute-name">id</span>="<span class="html-attribute-value">page-footer-container</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="276">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="277">
</td>
<td class="line-content">    <span class="html-tag">&lt;footer <span class="html-attribute-name">id</span>="<span class="html-attribute-value">page-footer</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">row</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="278">
</td>
<td class="line-content">      <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">six columns</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="279">
</td>
<td class="line-content">               <span class="html-tag">&lt;address <span class="html-attribute-name">id</span>="<span class="html-attribute-value">about</span>" <span class="html-attribute-name">class</span>="<span class="html-attribute-value">vcard body</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="280">
</td>
<td class="line-content">                  Copyright © 逆铭 (tomtung) 2012 </td>
</tr>
<tr>
<td class="line-number" value="281">
</td>
<td class="line-content">                  <span class="html-tag">&lt;a <span class="html-attribute-name">rel</span>="<span class="html-attribute-value">license</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">http://creativecommons.org/licenses/by-nc-sa/3.0/</a>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="282">
</td>
<td class="line-content">                    <span class="html-tag">&lt;img <span class="html-attribute-name">id</span>="<span class="html-attribute-value">license-image-80x15</span>" <span class="html-attribute-name">alt</span>="<span class="html-attribute-value">Creative Commons License</span>" <span class="html-attribute-name">style</span>="<span class="html-attribute-value">border-width:0</span>" <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png">http://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png</a>" /&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="283">
</td>
<td class="line-content">                  <span class="html-tag">&lt;/a&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="284">
</td>
<td class="line-content">                  <span class="html-tag">&lt;br /&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="285">
</td>
<td class="line-content">                  Proudly powered by <span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://getpelican.com/">http://getpelican.com/</a>"&gt;</span>Pelican<span class="html-tag">&lt;/a&gt;</span> and the <span class="html-tag">&lt;a <span class="html-attribute-name">target</span>="<span class="html-attribute-value">_blank</span>" <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://gumbyframework.com/">http://gumbyframework.com</a>"&gt;</span>Gumby Framework<span class="html-tag">&lt;/a&gt;</span>.</td>
</tr>
<tr>
<td class="line-number" value="286">
</td>
<td class="line-content">              <span class="html-tag">&lt;/address&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="287">
</td>
<td class="line-content">      <span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="288">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="289">
</td>
<td class="line-content">      <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">six columns</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="290">
</td>
<td class="line-content">        <span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">row</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="291">
</td>
<td class="line-content">          <span class="html-tag">&lt;ul <span class="html-attribute-name">id</span>="<span class="html-attribute-value">socbtns</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="292">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="293">
</td>
<td class="line-content">            <span class="html-tag">&lt;li&gt;</span>
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">btn primary</span>"&gt;</span>
<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://github.com/tomtung">https://github.com/tomtung</a>" <span class="html-attribute-name">target</span>="<span class="html-attribute-value">_blank</span>"&gt;</span>Github<span class="html-tag">&lt;/a&gt;</span>
<span class="html-tag">&lt;/div&gt;</span>
<span class="html-tag">&lt;/li&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="294">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="295">
</td>
<td class="line-content">            <span class="html-tag">&lt;li&gt;</span>
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">btn twitter</span>"&gt;</span>
<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="https://twitter.com/tomtung">https://twitter.com/tomtung</a>" <span class="html-attribute-name">target</span>="<span class="html-attribute-value">_blank</span>"&gt;</span>Twitter<span class="html-tag">&lt;/a&gt;</span>
<span class="html-tag">&lt;/div&gt;</span>
<span class="html-tag">&lt;/li&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="296">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="297">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="298">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="299">
</td>
<td class="line-content">            <span class="html-tag">&lt;li&gt;</span>
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">btn weibo</span>"&gt;</span>
<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.weibo.com/1245986775">http://www.weibo.com/1245986775</a>" <span class="html-attribute-name">target</span>="<span class="html-attribute-value">_blank</span>"&gt;</span>Weibo<span class="html-tag">&lt;/a&gt;</span>
<span class="html-tag">&lt;/div&gt;</span>
<span class="html-tag">&lt;/li&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="300">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="301">
</td>
<td class="line-content">            <span class="html-tag">&lt;li&gt;</span>
<span class="html-tag">&lt;div <span class="html-attribute-name">class</span>="<span class="html-attribute-value">btn douban</span>"&gt;</span>
<span class="html-tag">&lt;a <span class="html-attribute-name">href</span>="<a class="html-attribute-value html-external-link" target="_blank" href="http://www.douban.com/people/tomtung">http://www.douban.com/people/tomtung</a>" <span class="html-attribute-name">target</span>="<span class="html-attribute-value">_blank</span>"&gt;</span>Douban<span class="html-tag">&lt;/a&gt;</span>
<span class="html-tag">&lt;/div&gt;</span>
<span class="html-tag">&lt;/li&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="302">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="303">
</td>
<td class="line-content">          <span class="html-tag">&lt;/ul&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="304">
</td>
<td class="line-content">        <span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="305">
</td>
<td class="line-content">      <span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="306">
</td>
<td class="line-content">    <span class="html-tag">&lt;/footer&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="307">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="308">
</td>
<td class="line-content">    <span class="html-tag">&lt;/div&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="309">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="310">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="311">
</td>
<td class="line-content">
<span class="html-tag">&lt;script <span class="html-attribute-name">type</span>="<span class="html-attribute-value">text/javascript</span>"&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="312">
</td>
<td class="line-content">    var disqus_shortname = 'tomtung';</td>
</tr>
<tr>
<td class="line-number" value="313">
</td>
<td class="line-content">    (function () {</td>
</tr>
<tr>
<td class="line-number" value="314">
</td>
<td class="line-content">        var s = document.createElement('script'); s.async = true;</td>
</tr>
<tr>
<td class="line-number" value="315">
</td>
<td class="line-content">        s.type = 'text/javascript';</td>
</tr>
<tr>
<td class="line-number" value="316">
</td>
<td class="line-content">        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';</td>
</tr>
<tr>
<td class="line-number" value="317">
</td>
<td class="line-content">        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);</td>
</tr>
<tr>
<td class="line-number" value="318">
</td>
<td class="line-content">    }());</td>
</tr>
<tr>
<td class="line-number" value="319">
</td>
<td class="line-content">
<span class="html-tag">&lt;/script&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="320">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="321">
</td>
<td class="line-content">  <span class="html-comment">&lt;!-- Grab Google CDN's jQuery, fall back to local if offline --&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="322">
</td>
<td class="line-content">  <span class="html-comment">&lt;!-- 2.0 for modern browsers, 1.10 for .oldie --&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="323">
</td>
<td class="line-content">  <span class="html-tag">&lt;script&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="324">
</td>
<td class="line-content">    var oldieCheck = Boolean(document.getElementsByTagName('html')[0].className.match(/\soldie\s/g));</td>
</tr>
<tr>
<td class="line-number" value="325">
</td>
<td class="line-content">    if(!oldieCheck) {</td>
</tr>
<tr>
<td class="line-number" value="326">
</td>
<td class="line-content">    document.write('&lt;script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"&gt;&lt;\/script&gt;');</td>
</tr>
<tr>
<td class="line-number" value="327">
</td>
<td class="line-content">    } else {</td>
</tr>
<tr>
<td class="line-number" value="328">
</td>
<td class="line-content">    document.write('&lt;script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"&gt;&lt;\/script&gt;');</td>
</tr>
<tr>
<td class="line-number" value="329">
</td>
<td class="line-content">    }</td>
</tr>
<tr>
<td class="line-number" value="330">
</td>
<td class="line-content">  <span class="html-tag">&lt;/script&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="331">
</td>
<td class="line-content">  <span class="html-tag">&lt;script&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="332">
</td>
<td class="line-content">    if(!window.jQuery) {</td>
</tr>
<tr>
<td class="line-number" value="333">
</td>
<td class="line-content">    if(!oldieCheck) {</td>
</tr>
<tr>
<td class="line-number" value="334">
</td>
<td class="line-content">      document.write('&lt;script src="/bower_components/gumby/js/libs/jquery-2.0.2.min.js"&gt;&lt;\/script&gt;');</td>
</tr>
<tr>
<td class="line-number" value="335">
</td>
<td class="line-content">    } else {</td>
</tr>
<tr>
<td class="line-number" value="336">
</td>
<td class="line-content">      document.write('&lt;script src="/bower_components/gumby/js/libs/jquery-1.10.1.min.js"&gt;&lt;\/script&gt;');</td>
</tr>
<tr>
<td class="line-number" value="337">
</td>
<td class="line-content">    }</td>
</tr>
<tr>
<td class="line-number" value="338">
</td>
<td class="line-content">    }</td>
</tr>
<tr>
<td class="line-number" value="339">
</td>
<td class="line-content">  <span class="html-tag">&lt;/script&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="340">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="341">
</td>
<td class="line-content">  <span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://blog.tomtung.com/theme/js/libs/gumby.min.js">http://blog.tomtung.com/theme/js/libs/gumby.min.js</a>"&gt;</span>
<span class="html-tag">&lt;/script&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="342">
</td>
<td class="line-content">  <span class="html-tag">&lt;script <span class="html-attribute-name">src</span>="<a class="html-attribute-value html-resource-link" target="_blank" href="http://blog.tomtung.com/theme/js/plugins.js">http://blog.tomtung.com/theme/js/plugins.js</a>"&gt;</span>
<span class="html-tag">&lt;/script&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="343">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="344">
</td>
<td class="line-content">  <span class="html-comment">&lt;!-- Prompt IE 6 users to install Chrome Frame. Remove this if you want to support IE 6.</span>
</td>
</tr>
<tr>
<td class="line-number" value="345">
</td>
<td class="line-content">
<span class="html-comment">   chromium.org/developers/how-tos/chrome-frame-getting-started --&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="346">
</td>
<td class="line-content">  <span class="html-comment">&lt;!--[if lt IE 7 ]&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="347">
</td>
<td class="line-content">
<span class="html-comment">  &lt;script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"&gt;&lt;/script&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="348">
</td>
<td class="line-content">
<span class="html-comment">  &lt;script&gt;window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})&lt;/script&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="349">
</td>
<td class="line-content">
<span class="html-comment">  &lt;![endif]--&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="350">
</td>
<td class="line-content">
<br>
</td>
</tr>
<tr>
<td class="line-number" value="351">
</td>
<td class="line-content">
<span class="html-tag">&lt;/body&gt;</span>
</td>
</tr>
<tr>
<td class="line-number" value="352">
</td>
<td class="line-content">
<span class="html-tag">&lt;/html&gt;</span>
<span class="html-end-of-file">
</span>
</td>
</tr>
</tbody>
</table>
</body>
</html>